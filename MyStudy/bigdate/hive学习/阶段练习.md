# 1. 阶段练习

- 题目

```java
1、有一个线上服务器访问日志，格式如下

时间接口ip 地址

2016-11-09 11:22:05 /api/user/login 110.23.5.33

2016-11-09 11:23:10 /api/user/detail 57.1.2.3

…

2016-11-09 23:57:405 /api/user/login 200.233.25.133

求11 月9 号中午12 点（11:00-12:00）访问/api/user/login 接口的top10 的ip

地址和数量

2、hive 中有一个表test，结构是create table arrays( x artay< string>)，

且有:

hive >select * from test ;

OK

["a","b”]

[“c”,“d","e"]

1、请写出select explode(x) as xx from test；语句执行后的结果

2 、请写出select' ‘xx’ ， sp from test lateral view

explode( split( concat_ws(',’，’1’，’2’)，’,’)) el as sp；语句执行后

的结果

3、当前有用户人生阶段表Lifestage，有用户唯一1D 字段UID，用户人生阶段

字段stage，其中stage 字段受内容为各个人生阶段标签按照英文迎号分和的拼接

内容，如：计划买车，已买房,且与个用户的内容个同，请使用Hive Sql 统计每个

人生阶段的用户量。
```

- 数据

```java
2016-11-09 11:22:05 /api/user/login 110.23.5.33
2016-11-09 11:23:10 /api/user/index 57.1.2.3
2016-11-09 11:24:10 /api/user/index 57.1.2.3
2016-11-09 11:25:11 /api/user/login 57.1.2.3
2016-11-09 11:26:12 /api/user/home 57.1.2.3
2016-11-09 11:27:10 /api/user/home 57.1.2.3
2016-11-09 11:28:10 /api/user/home 57.1.2.3
2016-11-09 11:29:10 /api/user/detail 57.1.2.3
2016-11-09 11:30:10 /api/user/login 10.1.2.3
2016-11-09 11:31:10 /api/user/detail 57.1.2.3
2016-11-09 11:32:10 /api/user/detail 57.1.2.3
2016-11-09 11:33:10 /api/user/login 20.1.2.3
2016-11-09 11:34:10 /api/user/detail 57.1.2.3
2016-11-09 11:35:10 /api/user/detail 57.1.2.3
2016-11-09 11:36:10 /api/user/detail 57.1.2.3
2016-11-09 11:37:10 /api/user/detail 57.1.2.3
2016-11-09 11:40:10 /api/user/detail 57.1.2.3
2016-11-09 11:41:10 /api/user/login 30.1.2.3
2016-11-09 11:42:10 /api/user/detail 57.1.2.3
2016-11-09 11:43:10 /api/user/detail 57.1.2.3
2016-11-09 11:44:10 /api/user/login 40.1.2.3
2016-11-09 11:45:10 /api/user/detail 57.1.2.3
2016-11-09 11:46:10 /api/user/detail 57.1.2.3
2016-11-09 11:47:10 /api/user/detail 57.1.2.3
2016-11-09 11:48:10 /api/user/detail 57.1.2.3
2016-11-09 11:49:10 /api/user/login 57.1.2.3
2016-11-09 11:50:10 /api/user/detail 57.1.2.3
2016-11-09 11:51:10 /api/user/detail 57.1.2.3
2016-11-09 23:30:405 /api/user/login 200.233.25.133
2016-11-09 23:35:405 /api/user/login 200.233.25.133
2016-11-09 23:57:405 /api/user/login 200.233.25.133
2016-11-11 23:57:405 /api/user/login 200.233.25.133
2016-11-12 23:57:405 /api/user/login 200.233.25.133
2016-11-13 23:57:405 /api/user/login 200.233.25.133
2016-11-14 23:57:405 /api/user/login 200.233.25.133
```

- 建表

```java
 CREATE  TABLE  access2(
        date1 string,
        time string,
        address string,
        ip string
        )  
     
        ROW FORMAT
        DELIMITED FIELDS TERMINATED BY ' ';
```

- SQL实现

```java
select ip,count(*) from access where date1='2016-11-09' and time<='12:00:00' and time>= '11:00:00' group by ip order by ip desc limit 3;
```

